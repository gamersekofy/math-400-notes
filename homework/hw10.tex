\begin{center}
  \section*{Homework 10 - 4.5, 4.9}
  Due Wed 4/16 \\
  Uzair Hamed Mohammed
\end{center}

\subsection*{4.5 Gaussian Quadrature}

2e, 5

\begin{enumerate}
  \item[2e.] Approximate \(\int_{0}^{\frac{\pi}{4}} e^{3x} \sin 2x
    dx\) using Gaussian quadrature with n = 3 and compare your result
    to the exact value of the intergral.

    \underline{Sol}:\\

    \[
      \begin{aligned}
        & \text{Transform interval } [0, \tfrac{\pi}{4}] \text{ to } [-1, 1]: \\
        & x = \tfrac{\pi}{8}(t + 1), \quad dx = \tfrac{\pi}{8}dt \\
        & \text{Roots } r_i: 0.7745966692,\ 0,\ -0.7745966692;  \\
        & \text{Coefficients } c_i:
        0.5555555556,\ 0.8888888889,\ 0.5555555556 \\
        & f(x) = e^{3x}\sin 2x \\
        & \int_{0}^{\tfrac{\pi}{4}} f(x)dx \approx \tfrac{\pi}{8}
        \sum_{i=1}^{3} c_i f\left(\tfrac{\pi}{8}(r_i + 1)\right) \\
        & \approx \tfrac{\pi}{8} \left[ 0.5556f(0.6972) +
        0.8889f(0.3927) + 0.5556f(0.0882) \right] \\
        & \approx \tfrac{\pi}{8} \left[ 0.5556(7.950) + 0.8889(2.297)
        + 0.5556(0.229) \right] \\
        & \approx \tfrac{\pi}{8} \times 6.584 \approx 2.585 \\
        & \text{Exact value: } \tfrac{3e^{\tfrac{3\pi}{4}} + 2}{13}
        \approx 2.588 \\
        & \boxed{2.585} \quad (\text{Exact: } \boxed{2.588})
      \end{aligned}
    \]

  \item[5.] Determine constants \(a, b, c, \) and \(d\) that will
    produce a quadrature formula

    \[
      \int_{-1}^{1} f(x)dx = af(-1) + bf(1) + cf'(-1) + df'(1)
    \]

    that gives exact results for polynomials of degree 3 or less.

    \underline{Sol}:\\

    \[
      \begin{aligned}
        & \text{Test polynomials } f(x) = 1, x, x^2, x^3: \\
        &
        \begin{aligned}
          f(x) = 1:&\quad \int_{-1}^1 1\,dx = 2 = a + b &\Rightarrow&
          a + b = 2 \quad (1) \\
          f(x) = x:&\quad \int_{-1}^1 x\,dx = 0 = -a + b + c + d
          &\Rightarrow& -a + b + c + d = 0 \quad (2) \\
          f(x) = x^2:&\quad \int_{-1}^1 x^2\,dx = \tfrac{2}{3} = a +
          b - 2c + 2d &\Rightarrow& a + b - 2c + 2d = \tfrac{2}{3} \quad (3) \\
          f(x) = x^3:&\quad \int_{-1}^1 x^3\,dx = 0 = -a + b + 3c +
          3d &\Rightarrow& -a + b + 3c + 3d = 0 \quad (4)
        \end{aligned} \\
        & \text{Solve system:} \\
        &
        \begin{aligned}
          (1)\Rightarrow a &= 2 - b \\
          (2)+(1)\Rightarrow 2b + c + d &= 2 \\
          (3)-(1)\Rightarrow -2c + 2d &= -\tfrac{4}{3} \Rightarrow d
          = c - \tfrac{2}{3} \\
          (4)+(2)\Rightarrow 2b + 6c &= 4 \Rightarrow b = 2 - 3c \\
          \Rightarrow c &= \tfrac{1}{3},\ d = -\tfrac{1}{3},\ b = 1,\ a = 1
        \end{aligned} \\
        & \boxed{a = 1,\ b = 1,\ c = \tfrac{1}{3},\ d = -\tfrac{1}{3}}
      \end{aligned}
    \]

\end{enumerate}

\subsection*{4.9 Numerical Differentiation}

3 (a, b), 4 (a, b), 9, 10

\begin{enumerate}
  \item[3.] Use the most accurate three-point formula to determine
    each missing entry in the following tables.
    \begin{enumerate}
      \item[a.] \[
          \begin{array}{c|c|c}
            x & f(x) & f'(x) \\
            \hline
            1.1 & 9.025013 & \\
            1.2 & 11.02318 & \\
            1.3 & 13.46374 & \\
            1.4 & 16.44465 & \\
          \end{array}
        \]

        \underline{Sol}:\\

        \[
          \begin{array}{l}
            % x = 1.1 (Endpoint Formula)
            f'(1.1) \approx \frac{1}{2h}[-3f(1.1) + 4f(1.2) - f(1.3)] \\
            f'(1.1) \approx \frac{1}{2(0.1)}[-3(9.025013) + 4(11.02318) - 13.46374] \\
            f'(1.1) \approx \frac{1}{0.2}[-27.075039 + 44.09272 - 13.46374] \\
            f'(1.1) \approx 5[3.553941] = 17.769705 \\ \\
            % x = 1.2 (Midpoint Formula)
            f'(1.2) \approx \frac{1}{2h}[f(1.3) - f(1.1)] \\
            f'(1.2) \approx \frac{1}{2(0.1)}[13.46374 - 9.025013] \\
            f'(1.2) \approx \frac{1}{0.2}[4.438727] \\
            f'(1.2) \approx 5[4.438727] = 22.193635 \\ \\
            % x = 1.3 (Midpoint Formula)
            f'(1.3) \approx \frac{1}{2h}[f(1.4) - f(1.2)] \\
            f'(1.3) \approx \frac{1}{2(0.1)}[16.44465 - 11.02318] \\
            f'(1.3) \approx \frac{1}{0.2}[5.42147] \\
            f'(1.3) \approx 5[5.42147] = 27.10735 \\ \\
            % x = 1.4 (Endpoint Formula - backward)
            f'(1.4) \approx \frac{1}{2h}[f(1.2) - 4f(1.3) + 3f(1.4)] \\ % Note: Backward version
            f'(1.4) \approx \frac{1}{2(0.1)}[11.02318 - 4(13.46374) + 3(16.44465)] \\
            f'(1.4) \approx \frac{1}{0.2}[11.02318 - 53.85496 + 49.33395] \\
            f'(1.4) \approx 5[6.50217] = 32.51085 \\ \\
            \multicolumn{1}{c}{\text{Updated Table:}} \\
            \begin{array}{c|c|c}
            x & f(x) & f'(x) \\
            \hline
            1.1 & 9.025013 & 17.769705 \\
            1.2 & 11.02318 & 22.193635 \\
            1.3 & 13.46374 & 27.10735 \\
            1.4 & 16.44465 & 32.51085 \\
            \end{array}
            \end{array}
        \]

      \item[b.] \[
          \begin{array}{c|c|c}
            x & f(x) & f'(x) \\
            \hline
            8.1 & 16.94410 & \\
            8.3 & 17.56492 & \\
            8.5 & 18.19056 & \\
            8.7 & 18.82091 & \\
          \end{array}
        \]

        \underline{Sol}:\\

        \[
          \begin{array}{l}
            % x = 8.1 (Endpoint Formula)
            f'(8.1) \approx \frac{1}{2h}[-3f(8.1) + 4f(8.3) - f(8.5)] \\
            f'(8.1) \approx \frac{1}{2(0.2)}[-3(16.94410) + 4(17.56492) - 18.19056] \\
            f'(8.1) \approx \frac{1}{0.4}[-50.8323 + 70.25968 - 18.19056] \\
            f'(8.1) \approx 2.5[1.23682] = 3.09205 \\ \\
            % x = 8.3 (Midpoint Formula)
            f'(8.3) \approx \frac{1}{2h}[f(8.5) - f(8.1)] \\
            f'(8.3) \approx \frac{1}{2(0.2)}[18.19056 - 16.94410] \\
            f'(8.3) \approx \frac{1}{0.4}[1.24646] \\
            f'(8.3) \approx 2.5[1.24646] = 3.11615 \\ \\
            % x = 8.5 (Midpoint Formula)
            f'(8.5) \approx \frac{1}{2h}[f(8.7) - f(8.3)] \\
            f'(8.5) \approx \frac{1}{2(0.2)}[18.82091 - 17.56492] \\
            f'(8.5) \approx \frac{1}{0.4}[1.25599] \\
            f'(8.5) \approx 2.5[1.25599] = 3.139975 \\ \\
            % x = 8.7 (Endpoint Formula - backward)
            f'(8.7) \approx \frac{1}{2h}[f(8.3) - 4f(8.5) + 3f(8.7)] \\ % Note: Backward version
            f'(8.7) \approx \frac{1}{2(0.2)}[17.56492 - 4(18.19056) + 3(18.82091)] \\
            f'(8.7) \approx \frac{1}{0.4}[17.56492 - 72.76224 + 56.46273] \\
            f'(8.7) \approx 2.5[1.26541] = 3.163525 \\ \\
            \multicolumn{1}{c}{\text{Updated Table:}} \\
            \begin{array}{c|c|c}
            x & f(x) & f'(x) \\
            \hline
            8.1 & 16.94410 & 3.09205 \\
            8.3 & 17.56492 & 3.11615 \\
            8.5 & 18.19056 & 3.139975 \\
            8.7 & 18.82091 & 3.163525 \\
            \end{array}
            \end{array}
        \]
    \end{enumerate}

    \item[4.] The data in Exercise 3 were taken from the following functions. Compute the actual errors in Exercise 3, and find error bounds using the error formula. 
    
      \begin{enumerate}
        \item[a.] \(f(x) = e^{2x}\)
        
        \underline{Sol}:\\
        
        \[
            \begin{array}{c|c|c|c}
              x & \text{Approx } f'(x) & \text{Actual Error} & \text{Error Bound} \\
              \hline
              1.1 & 17.7697 & |18.0500 - 17.7697| = 0.2803 & \tfrac{(0.1)^2}{3} \cdot 8e^{2.8} \approx 0.4385 \\
              1.2 & 22.1936 & |22.0464 - 22.1936| = 0.1472 & \tfrac{(0.1)^2}{6} \cdot 8e^{2.6} \approx 0.2193 \\
              1.3 & 27.1074 & |26.9275 - 27.1074| = 0.1799 & \tfrac{(0.1)^2}{6} \cdot 8e^{2.6} \approx 0.2193 \\
              1.4 & 32.5109 & |32.8893 - 32.5109| = 0.3784 & \tfrac{(0.1)^2}{3} \cdot 8e^{2.8} \approx 0.4385 \\
            \end{array}
        \]

        \item[b.] \(f(x) = x \ln x\)
        
        \underline{Sol}:\\

        \[
          \begin{array}{c|c|c|c}
            x & \text{Approx } f'(x) & \text{Actual Error} & \text{Error Bound} \\
            \hline
            8.1 & 3.0921 & |3.091864 - 3.0921| = 0.000236 & \tfrac{(0.2)^2}{3} \cdot \tfrac{1}{(8.1)^2} \approx 0.000203 \\
            8.3 & 3.1162 & |3.116256 - 3.1162| = 0.000056 & \tfrac{(0.2)^2}{6} \cdot \tfrac{1}{(8.3)^2} \approx 0.000096 \\
            8.5 & 3.1400 & |3.140066 - 3.1400| = 0.000066 & \tfrac{(0.2)^2}{6} \cdot \tfrac{1}{(8.5)^2} \approx 0.000086 \\
            8.7 & 3.1635 & |3.163151 - 3.1635| = 0.000349 & \tfrac{(0.2)^2}{3} \cdot \tfrac{1}{(8.7)^2} \approx 0.000165 \\
          \end{array}
        \]
      \end{enumerate}

      \item[9.] Use the following data and the knowledge that the first five derivatives of \(f\) were bounded on [1, 5] by 2, 3, 6, 12, and 23, respectively, to approximate \(f'(3)\) as accurately as possible. Find a bound for the error. 
      
          \[
            \begin{array}{l|l|l|l|l|l}
              x & 1 & 2 & 3 & 4 & 5 \\
              \hline
              f(x) & 2.4142 & 2.6734 & 2.8974 & 3.0976 & 3.2804 
            \end{array}
          \]

        \underline{Sol}:\\


        \[
\begin{aligned}
  & \text{Use five-point formula with } h=1: \\
  & f'(3) \approx \frac{-f(5) + 8f(4) - 8f(2) + f(1)}{12} \\
  & = \frac{-3.2804 + 8(3.0976) - 8(2.6734) + 2.4142}{12} \\
  & = \frac{2.5274}{12} \approx 0.2106 \\
  & \text{Error bound: } \frac{h^4}{30} \cdot M_5 = \frac{1^4}{30} \cdot 23 \approx 0.7667 \\
  & \boxed{0.211} \quad \text{with error bound} \quad \boxed{0.767}
\end{aligned}
\]

\item[10.] Repeat Exercise 9, assuming instead that the third derivative of \(f\) is bounded on [1, 5] by 4. 

  \underline{Sol}:\\

  \[
\begin{aligned}
  & \text{Use three-point midpoint formula with } h=1: \\
  & f'(3) \approx \frac{f(4) - f(2)}{2 \cdot 1} = \frac{3.0976 - 2.6734}{2} = 0.2121 \\
  & \text{Error bound: } \frac{h^2}{6} \cdot M_3 = \frac{1^2}{6} \cdot 4 = \frac{2}{3} \approx 0.6667 \\
  & \boxed{0.212} \quad \text{with error bound} \quad \boxed{0.667}
\end{aligned}
\]

\end{enumerate}
